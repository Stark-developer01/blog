<!doctype html><html class="no-js"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="“Playing with maths, geometry and Base64 encoded SVGs”"><link rel="shortcut icon" href="/favicon.ico"><link href="/css/screen.css" media="screen, projection" rel="stylesheet" type="text/css"><script src="/../bower_components/modernizr/modernizr.js"></script><title>Sam Beckham | Generated Backgrounds With SVG</title></head><body><div class="hide"><svg viewbox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><symbol viewbox="0 0 410 660" id="icon__logo"><title>logo</title><path d="M201 247C175 247 154 226 154 200 154 187 159.3 175.3 167.8 166.8 176.3 158.3 188 153 201 153 227 153 248 174 248 200 248 210.6 244.5 220.3 238.6 228.2 291.7 237.3 338.2 265.5 371 305.4L371 305.4C390 274.8 401 238.7 401 200 401 89.5 311.5 0 201 0 90.5 0 1 89.5 1 200 1 219.3 3.7 238 8.9 255.7L8.9 255.7C32.9 338.8 109.3 399.6 200 400 226 400 247 421 247 447 247 460 241.7 471.7 233.2 480.2 224.7 488.7 213 494 200 494 174 494 153 473 153 447 153 436.4 156.5 426.7 162.4 418.8 109.3 409.7 62.8 381.5 30 341.6L30 341.6C11 372.2 0 408.3 0 447 0 557.5 89.5 647 200 647 310.5 647 400 557.5 400 447 400 427.7 397.3 409 392.1 391.3L392.1 391.3C368.1 308.2 291.7 247.4 201 247L201 247Z"></symbol></svg></div><header class="page-header" role="banner"><div class="wrapper"><a href="/" class="main-logo" title="home"><svg viewbox="0 0 100 100" class="icon icon__logo"><use xlink:href="#icon__logo"></use></svg></a><nav class="nav nav--main"><ul><li class="nav__blog"><a href="/wrote">Blog</a></li><li class="nav__contact"><a href="/contact">Contact</a></li></ul></nav></div></header><main role="main"><article class="page article"><header class="page__header" style="background: #8e44ad"><div class="wrapper"><div class="page__header__headings"><h1>Generated Backgrounds With SVG</h1><span class="page__date--header">15 January 2014</span></div></div></header><div class="wrapper"><div class="page__content"><p>Just before Christmas I decided to have a play about with SVG on Codepen. It got quite a lot of attention and I was asked to write a post detailing the process; here is that post.</p><p>This idea was born because I needed a way to generate isometric backgrounds on-the-fly with a set colour palette. I decided the best way to do it would be to use a formula that would write some SVG code and apply it to the background of an element. The problem was, I’d never used SVG before and <a href="http://i.imgur.com/EiVhZ.gif">I had no idea what I was doing</a>.</p><h2 id="polka-dots">Polka dots</h2><p>I decided to start small and get the basics down first. If I could get something simple generated in SVG first then I could move onto writing the formula that would generate my shapes. I created a <a href="http://codepen.io/sambeckham/pen/ouvGg">random polka dot generator</a> that was surprisingly simple.</p><p>I’ve outlined a - simplified - breakdown of that code below.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">width</span> <span class="o">=</span> <span class="p">(</span><span class="nx">dotSize</span> <span class="o">+</span> <span class="nx">dotPadding</span><span class="p">)</span> <span class="o">*</span> <span class="nx">dotsWide</span><span class="p">,</span>
    <span class="nx">height</span> <span class="o">=</span> <span class="p">(</span><span class="nx">dotSize</span> <span class="o">+</span> <span class="nx">dotPadding</span><span class="p">)</span> <span class="o">*</span> <span class="nx">dotsHigh</span><span class="p">,</span>
    <span class="nx">radius</span> <span class="o">=</span> <span class="nx">dotSize</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
    <span class="nx">background</span> <span class="o">=</span> <span class="s2">&quot;&lt;svg xmlns=&#39;http://www.w3.org/2000/svg&#39; width=&#39;&quot;</span> <span class="o">+</span> <span class="nx">width</span> <span class="o">+</span> <span class="s2">&quot;&#39; height=&#39;&quot;</span> <span class="o">+</span> <span class="nx">height</span> <span class="o">+</span> <span class="s2">&quot;&#39;&gt;&quot;</span><span class="p">,</span>
    <span class="nx">color</span> <span class="o">=</span> <span class="s2">&quot;#09c&quot;</span><span class="p">,</span>
    <span class="nx">x</span><span class="p">,</span>
    <span class="nx">y</span><span class="p">;</span></code></pre></div><p>First I define the variables I’m going to use and generate the opening tag for the SVG (assigned to the background variable).</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="k">for</span> <span class="p">(</span><span class="nx">x</span> <span class="o">=</span> <span class="nx">radius</span><span class="p">;</span> <span class="nx">x</span> <span class="o">&lt;</span> <span class="nx">width</span><span class="p">;</span> <span class="nx">x</span> <span class="o">+=</span> <span class="nx">dotSize</span> <span class="o">+</span> <span class="nx">dotPadding</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="nx">y</span> <span class="o">=</span> <span class="nx">radius</span><span class="p">;</span> <span class="nx">y</span> <span class="o">&lt;</span> <span class="nx">height</span><span class="p">;</span> <span class="nx">y</span> <span class="o">+=</span> <span class="nx">dotSize</span> <span class="o">+</span> <span class="nx">dotPadding</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">background</span> <span class="o">+=</span> <span class="s2">&quot;&lt;circle fill=&#39;&quot;</span> <span class="o">+</span> <span class="nx">color</span> <span class="o">+</span> <span class="s2">&quot;&#39; cx=&#39;&quot;</span> <span class="o">+</span> <span class="nx">x</span> <span class="o">+</span> <span class="s2">&quot;&#39; cy=&#39;&quot;</span> <span class="o">+</span> <span class="nx">y</span> <span class="o">+</span> <span class="s2">&quot;&#39; r=&#39;&quot;</span> <span class="o">+</span> <span class="nx">radius</span> <span class="o">+</span> <span class="s2">&quot;&#39;/&gt;&quot;</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></div><p>Then I loop through each circle/dot in the image and append the SVG code to generate it to the background variable.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">background</span> <span class="o">+=</span> <span class="s2">&quot;&lt;/svg&gt;&quot;</span><span class="p">;</span></code></pre></div><p>Once each dot has been added, we close the SVG tag.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">b64</span> <span class="o">=</span> <span class="s1">&#39;data:image/svg+xml;base64,&#39;</span> <span class="o">+</span> <span class="nb">window</span><span class="p">.</span><span class="nx">btoa</span><span class="p">(</span><span class="nx">background</span><span class="p">),</span>
    <span class="nx">url</span> <span class="o">=</span> <span class="s1">&#39;url(&quot;&#39;</span> <span class="o">+</span> <span class="nx">b64</span> <span class="o">+</span> <span class="s1">&#39;&quot;)&#39;</span><span class="p">;</span>
<span class="nx">$</span><span class="p">(</span><span class="s1">&#39;html&#39;</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s1">&#39;backgroundImage&#39;</span><span class="p">,</span> <span class="nx">url</span><span class="p">);</span></code></pre></div><p>Finally I base64 encode the image before applying it to the background as a <a href="http://css-tricks.com/data-uris/">Data URI</a>.</p><h2 id="isometric-grid">Isometric grid</h2><p>The polka dot demo proved to me that I could do this. All I had to do now was write the part that generated my isometric triangles. There’s a few ways to do this but I found this way to be the simplest.</p><p><img src="/images/articles/svg/concept.jpg" alt="concept drawing"></p><p>My plan was to generate this bow-tie shape and fill it with a random colour, chosen from a pre-defined array. I would then repeat this shape so it tessellates. The problem I encountered with this approach is that they didn’t stack correctly, and I had with a line of diamond-shaped gaps.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;=</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">trianglesWide</span><span class="p">;</span> <span class="nx">i</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;=</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">trianglesHigh</span><span class="p">;</span> <span class="nx">j</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">v</span> <span class="o">=</span> <span class="nx">i</span> <span class="o">*</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">triangleSize</span> <span class="o">*</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">skew</span><span class="p">;</span>
        <span class="nx">w</span> <span class="o">=</span> <span class="nx">j</span> <span class="o">*</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">triangleSize</span><span class="p">;</span>
        <span class="nx">x</span> <span class="o">=</span> <span class="nx">v</span> <span class="o">+</span> <span class="p">(</span><span class="nx">settings</span><span class="p">.</span><span class="nx">triangleSize</span> <span class="o">*</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">skew</span><span class="p">);</span>
        <span class="nx">y</span> <span class="o">=</span> <span class="nx">w</span> <span class="o">+</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">triangleSize</span><span class="p">;</span>
        <span class="nx">a</span> <span class="o">=</span> <span class="nx">v</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="nx">w</span><span class="p">;</span>
        <span class="nx">b</span> <span class="o">=</span> <span class="nx">x</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="nx">w</span><span class="p">;</span>
        <span class="nx">c</span> <span class="o">=</span> <span class="p">(</span><span class="nx">v</span> <span class="o">+</span> <span class="nx">x</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="p">((</span><span class="nx">w</span> <span class="o">+</span> <span class="nx">y</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">);</span>
        <span class="nx">d</span> <span class="o">=</span> <span class="nx">v</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="nx">y</span><span class="p">;</span>
        <span class="nx">e</span> <span class="o">=</span> <span class="nx">x</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="nx">y</span><span class="p">;</span>

        <span class="nx">background</span> <span class="o">+=</span> <span class="s2">&quot;&lt;polygon fill=&#39;&quot;</span> <span class="o">+</span> <span class="nx">getColor</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39; fill-opacity=&#39;&quot;</span> <span class="o">+</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">opacity</span> <span class="o">+</span> <span class="s2">&quot;&#39; points=&#39;&quot;</span> <span class="o">+</span> <span class="nx">a</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nx">c</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nx">d</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="s2">&quot;&#39; /&gt;&quot;</span><span class="p">;</span>
        <span class="nx">background</span> <span class="o">+=</span> <span class="s2">&quot;&lt;polygon fill=&#39;&quot;</span> <span class="o">+</span> <span class="nx">getColor</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39; fill-opacity=&#39;&quot;</span> <span class="o">+</span> <span class="nx">settings</span><span class="p">.</span><span class="nx">opacity</span> <span class="o">+</span> <span class="s2">&quot;&#39; points=&#39;&quot;</span> <span class="o">+</span> <span class="nx">b</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nx">c</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nx">e</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="s2">&quot;&#39; /&gt;&quot;</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></div><p>Gives you…</p><div style="background-image:url('/images/articles/svg/failed-attempt.png');background-position:center;height:250px;margin-bottom:0.618033em"></div><p>As you can see, the bow-ties don’t line up quite right but this is fixable. What we need to do is offset every second row by moving it up and along by 50%. I decided to utilise the <a href="http://en.wikipedia.org/wiki/Modulo_operation">modulo operation</a> <code>(j % 1)</code> to differentiate between even and odd rows. This operation will return a 0 when the number is even and a 1 when it’s odd.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;=</span> <span class="nx">trianglesWide</span><span class="p">;</span> <span class="nx">i</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span> <span class="p">(</span><span class="nx">j</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">;</span> <span class="nx">j</span> <span class="o">&lt;=</span> <span class="nx">trianglesHigh</span><span class="p">;</span> <span class="nx">j</span> <span class="o">+=</span> <span class="mf">0.5</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">v</span> <span class="o">=</span> <span class="p">(</span><span class="nx">i</span> <span class="o">+</span> <span class="p">(</span><span class="nx">j</span> <span class="o">%</span> <span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="nx">triangleSize</span> <span class="o">*</span> <span class="nx">skew</span><span class="p">;</span>
        <span class="nx">w</span> <span class="o">=</span> <span class="nx">j</span> <span class="o">*</span> <span class="nx">triangleSize</span><span class="p">;</span>
        <span class="nx">x</span> <span class="o">=</span> <span class="nx">v</span> <span class="o">+</span> <span class="p">(</span><span class="nx">triangleSize</span> <span class="o">*</span> <span class="nx">skew</span><span class="p">);</span>
        <span class="nx">y</span> <span class="o">=</span> <span class="nx">w</span> <span class="o">+</span> <span class="nx">triangleSize</span><span class="p">;</span>
        <span class="nx">a</span> <span class="o">=</span> <span class="nx">v</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="nx">w</span><span class="p">;</span>
        <span class="nx">b</span> <span class="o">=</span> <span class="nx">x</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="nx">w</span><span class="p">;</span>
        <span class="nx">c</span> <span class="o">=</span> <span class="p">(</span><span class="nx">v</span> <span class="o">+</span> <span class="nx">x</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="p">((</span><span class="nx">w</span> <span class="o">+</span> <span class="nx">y</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">);</span>
        <span class="nx">d</span> <span class="o">=</span> <span class="nx">v</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="nx">y</span><span class="p">;</span>
        <span class="nx">e</span> <span class="o">=</span> <span class="nx">x</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="nx">y</span><span class="p">;</span>

        <span class="nx">background</span> <span class="o">+=</span> <span class="s2">&quot;&lt;polygon fill=&#39;&quot;</span> <span class="o">+</span> <span class="nx">getColor</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39; fill-opacity=&#39;&quot;</span> <span class="o">+</span> <span class="nx">opacity</span> <span class="o">+</span> <span class="s2">&quot;&#39; points=&#39;&quot;</span> <span class="o">+</span> <span class="nx">a</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nx">c</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nx">d</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="s2">&quot;&#39; /&gt;&quot;</span><span class="p">;</span>
        <span class="nx">background</span> <span class="o">+=</span> <span class="s2">&quot;&lt;polygon fill=&#39;&quot;</span> <span class="o">+</span> <span class="nx">getColor</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;&#39; fill-opacity=&#39;&quot;</span> <span class="o">+</span> <span class="nx">opacity</span> <span class="o">+</span> <span class="s2">&quot;&#39; points=&#39;&quot;</span> <span class="o">+</span> <span class="nx">b</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nx">c</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="nx">e</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">+</span> <span class="s2">&quot;&#39; /&gt;&quot;</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span></code></pre></div><p>Adding this in allows us to offset the <code>v</code> coordinate by 1 on every second row which pushes that row along to the correct point.</p><p>You might notice that instead of starting the for loops at 0 I start them at −1 and −0.5 respectively. This is to make sure the pattern starts outside the bounding box so we don’t get jagged edges.</p><h2 id="colours">Colours</h2><p>Another big part of what I wanted to do here was to use random colours from a selected palette. To do this I wrote a simple <code>getColor()</code> function.</p><div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="kd">var</span> <span class="nx">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;green&#39;</span><span class="p">],</span>
    <span class="nx">getColor</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">hex</span> <span class="o">=</span> <span class="nx">colors</span><span class="p">[</span><span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="nx">colors</span><span class="p">.</span><span class="nx">length</span><span class="p">)];</span>
        <span class="k">return</span> <span class="nx">hex</span><span class="p">;</span>
    <span class="p">};</span></code></pre></div><p>This shouldn’t need too much of an explanation, it returns a random entry from the colours array when it’s called.</p><h2 id="plugin">Plugin</h2><p>Whilst this is not intended to be a jQuery plugin, I wrote it in that manner to allow me to generate several different backgrounds. Have a play about with the settings at the <a href="#top">top of the page</a> or check out the demo on <a href="http://codepen.io/sambeckham/pen/FCGrx">Codepen</a> to see just how versatile this can be.</p></div></div></article></main><footer class="footer" style="background: #8e44ad"><div class="wrapper"><a href="/" class="main-logo" title="home"><svg viewbox="0 0 100 100" class="icon icon__logo"><use xlink:href="#icon__logo"></use></svg></a><nav class="nav nav--footer"><ul><li class="nav__blog"><a href="/wrote">Blog</a></li><li class="nav__contact"><a href="/contact">Contact</a></li></ul></nav>Follow me on, <a href="http://www.twitter.com/samdbeckham">Twitter</a>, <a href="http://www.github.com/sambeckham">GitHub</a> or <a href="http://www.instagram.com/neilbuchanan">Instagram</a> <a class="disclaimer" href="/"><small>&copy; 2015 Sam Beckham</small></a></div></footer></body></html>